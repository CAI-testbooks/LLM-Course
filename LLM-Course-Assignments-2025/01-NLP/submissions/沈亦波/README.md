# 基于RAG的医学智能问答系统实验报告

## 1. 项目概述
本项目旨在构建一个基于**检索增强生成（RAG）** 的医学问答系统，整合百度翻译API、FAISS向量检索与DeepSeek大模型，实现“中文医学问题→英文文献检索→精准医学回答”的端到端流程。系统具备医学文本翻译、文献检索增强、大模型问答三大核心功能，为医学专业人士及普通用户提供高效、准确的医学知识查询服务。

## 2.核心功能

1. **医学文本翻译**：封装百度通用翻译API，实现中文医学问题到英文的精准翻译（术语适配）；
2. **RAG检索**：基于FAISS构建医学文献向量库，支持不同相似度阈值下的精准检索；
3. **大模型问答**：调用DeepSeek API，结合检索结果生成专业医学回答；

## 3.目录结构

```
medical-qa-system/
├── src/                        # 源代码文件夹
│   ├── model/                  # 核心模型模块
│   │   ├── llm_api.py          # 大模型问答逻辑（DeepSeek API调用）
│   │   ├── rag.py              # RAG检索实现（FAISS构建、索引构建、相似度检索）
│   │   ├── translate.py        # 百度通用翻译封装（医学文本中英互译）
│   ├── util/                   # 工具模块
│   │   └── download_pubmed.py  # PubMed 文献数据下载与预处理
│   ├── chat_web.py                 # 前端页面
│   ├── pubmed.json                 # PubMed 医学文献语料库
│   └── requirements.txt            # 依赖库列表
├── results/                    # 实验结果
│   ├── medical_translation_report.txt        # 翻译结果对比文件
│   └── medical_translation_response_time.txt # 翻译时间折线图
├── scripts/                    # 运行脚本
│   └── run.sh                  # 一键运行脚本
└── README.md                   # 说明文档
```



## 4. 数据来源与处理

- **数据来源**：使用PubMed数据库，通过`download_pubmed.py`脚本下载指定时间段（如2025年6月1日至2025年12月31日）的医学文献摘要。
- **数据清洗**：去除HTML标签、特殊符号及冗余空格，保留标题、摘要、发表日期等关键信息。
- **分块处理**：使用TokenTextSplitter将文献摘要切分为固定长度（chunk_size=128, overlap=64）的文本片段，便于后续向量化检索。

## 5. 方法

### 5.1 系统架构
1. **前端交互**：基于Streamlit构建Web界面，支持用户输入医学问题并实时展示问答历史。
2. **翻译模块**：调用百度通用翻译API，将中文医学问题转换为英文查询语句。
3. **向量检索**：
   - 使用`all-mpnet-base-v2`模型生成文本向量；
   - 基于FAISS构建向量数据库，支持相似度检索；
   - 设置相似度阈值（0.4）进行相关文献筛选与去重。
4. **大模型生成**：
   - 调用DeepSeek API，结合检索结果生成专业、通俗的医学回答；
   - 系统提示词限定回答范围与格式，确保回答专业性与安全性。

### 5.2 工作流程
```
用户输入（中文） → 百度翻译 → 英文查询 → FAISS检索 → 相关文献 → DeepSeek生成 → 中文回答
```

## 6. 实验结果

### 6.1 翻译性能测试
对50个医学问题进行了翻译测试，结果如下：

| 指标         | 数值     |
| ------------ | -------- |
| 调用次数     | 50       |
| 成功率       | 100%     |
| 总耗时       | 12.770秒 |
| 平均响应时间 | 0.255秒  |
| 最快响应时间 | 0.144秒  |
| 最慢响应时间 | 0.827秒  |

> 详细翻译结果见附件：`medical_translation_report.txt`

### 6.2 响应时间分布曲线
下图展示了50次翻译调用的响应时间分布：

```
50个医学问题翻译 - 百度API响应时间分布
单位时间（秒）
0.8
0.7
0.6
0.5
0.4
0.3
0.2
0
5 10 15 20 25 30 35 40 45 50
单次响应时间
平均响应时间（0.255秒）
调用序号（医学问题）
```

> 图表见附件：`medical_translation_response_time.png`

### 6.3 问答效果示例
系统在以下典型医学问题上表现良好：
- 糖尿病早期症状
- 高血压饮食建议
- 肺癌常见治疗方法
- 药物副作用查询
- 孕期疫苗接种建议

## 7. 问题分析与创新点

### 7.1 遇到的问题
1. **翻译术语一致性**：部分医学专有名词在翻译过程中存在不一致性，需后续构建医学术语词典进行校准。
2. **检索结果冗余**：相似文献较多时可能出现重复或冗余，已通过文献标题去重与相似度排序缓解。
3. **响应时间波动**：个别查询响应时间较长（如0.827秒），可能与网络延迟或API负载相关。

### 7.2 创新点
1. **端到端中英混合流程**：结合翻译与RAG，实现中文提问、英文检索、中文回答的无缝衔接。
2. **医学领域优化**：
   - 使用医学文献作为检索源，提升回答专业性；
   - 设定相似度阈值，过滤低质量检索结果；
   - 提示词工程约束回答范围与格式。
3. **模块化设计**：各功能模块（翻译、检索、生成）高度解耦，便于扩展与维护。

## 8. Demo截图与链接
- **本地运行界面**：
  ```
  streamlit run src/chat_web.py
  ```
- **响应时间分布**（示例）：
  ![image-20260111200748859](C:\Users\Administrator\AppData\Roaming\Typora\typora-user-images\image-20260111200748859.png)
  
- **项目代码仓库**：[20030718/-01-NLP-SX2516142---RAG-](https://github.com/20030718/-01-NLP-SX2516142---RAG-) 
  **

## 9. 未来改进方向
1. **多语言支持**：扩展翻译模块，支持更多语言（如日文、法文）的医学查询。
2. **多源数据融合**：引入更多医学数据源（如ClinicalTrials.gov、医学教科书）提升知识覆盖。
3. **检索优化**：
   - 尝试多向量检索策略（如HyDE、Multi-Query）；
   - 引入检索结果重排序（Reranking）模型。
4. **系统性能提升**：
   - 实现向量数据库的增量更新；
   - 优化大模型调用策略（如缓存、批处理）。
5. **评估体系构建**：设计医学问答评估指标（如准确率、安全性、可读性），进行系统性评测。

---

**报告撰写人**：沈亦波

日期**：2025年12月6日  **

附件**：`medical_translation_report.txt`, `medical_translation_response_time.png`, `README.md`, 相关代码文件
