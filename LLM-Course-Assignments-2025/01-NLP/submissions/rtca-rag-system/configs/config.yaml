# RTCA DO-160G RAG系统配置示例
# 复制此文件为 config.yaml 并修改配置

system:
  name: "rtca-rag-system"
  version: "1.0.0"
  environment: "development"  # development, testing, production

model:
  base_model: "Qwen/Qwen2.5-7B-Instruct"
  embedding_model: "BAAI/bge-large-zh-v1.5"
  device: "cuda"  # cuda, cpu, auto
  quantization: "bf16"  # fp16, bf16, int8, int4
  
  generation:
    max_new_tokens: 1024
    temperature: 0.7
    top_p: 0.9
    repetition_penalty: 1.1
  
  fine_tuning:
    use_lora: false
    lora_rank: 16
    lora_alpha: 32
    lora_dropout: 0.1
    target_modules: ["q_proj", "v_proj", "k_proj", "o_proj"]
    learning_rate: 2e-4
    num_epochs: 3

retrieval:
  strategy: "hybrid"  # dense, sparse, hybrid, rerank
  top_k: 5
  rerank_top_n: 3
  chunk_size: 512
  chunk_overlap: 50
  
  hybrid_weights:
    dense: 0.5
    sparse: 0.5

data:
  paths:
    raw_documents: "./data/raw"
    processed_chunks: "./data/processed/chunks.json"
    vector_db: "./data/vector_db"
    fine_tune_data: "./data/fine_tune"
    evaluation_data: "./data/evaluation"
  
  processing:
    languages: ["zh", "en"]
    extract_tables: true
    extract_images: false
    min_chunk_size: 100
    max_chunk_size: 1000

api:
  web:
    host: "0.0.0.0"
    port: 7860
    debug: true
    share: false
    
  fastapi:
    host: "0.0.0.0"
    port: 8000
    workers: 2
    timeout: 30
    max_requests: 1000

evaluation:
  metrics:
    - "accuracy"
    - "rouge"
    - "bleu" 
    - "hallucination_rate"
    - "citation_f1"
  
  benchmarks:
    - "cmedqa"
    - "legalbench"
    - "custom"
  
  thresholds:
    confidence: 0.7
    rouge_l: 0.6
    hallucination_rate: 0.1

logging:
  level: "INFO"  # DEBUG, INFO, WARNING, ERROR, CRITICAL
  file: "./outputs/logs/app.log"
  format: "%(asctime)s - %(name)s - %(levelname)s - %(message)s"
  max_size: 10485760  # 10MB
  backup_count: 5

monitoring:
  enable: true
  metrics_port: 9090
  collect_interval: 60
  
  metrics:
    - "response_time"
    - "retrieval_time"
    - "generation_time"
    - "cache_hit_rate"
    - "error_rate"

cache:
  enable: true
  type: "redis"  # memory, redis, memcached
  host: "localhost"
  port: 6379
  ttl: 3600  # 秒

security:
  enable_auth: false
  api_key: ""
  cors_origins: ["http://localhost:7860", "http://localhost:8000"]
  rate_limit:
    enable: true
    requests_per_minute: 60