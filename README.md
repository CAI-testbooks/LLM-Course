

# ControlExpert 2.0 - 自动控制原理智能问答系统

## 1. 项目简介

本项目旨在开发一个面向“自动控制原理”课程的深度 RAG（检索增强生成）问答系统。通过集成轻量化大语言模型（Qwen2.5-1.5B）与专业知识库，解决复杂控制理论问题的精准检索与智能化解答，作为高效的辅助学习工具。

## 2. 核心功能

- **大规模专业语料**：基于教材与习题集，构建了包含 5000+ 条高质量 QA 数据对的向量数据库。
- **精准页码溯源**：**[特色]** 实现了 PDF 物理页码与逻辑页码的自动修正算法，回答可精准定位至教材具体页码（如“参考来源：教材原文 - 第 58 页”）。
- **专业数学支持**：内置 LaTeX 渲染引擎，确保传递函数 $$G(s)$$、状态空间矩阵、拉普拉斯变换等公式在 Markdown 环境下清晰显示。
- **高性能检索**：采用 FAISS 本地向量数据库，配合 BGE-Small-ZH 嵌入模型，实现毫秒级知识点定位。
- **拒绝虚假回答**：内置检索相关度阈值过滤机制（Threshold Filtering），对非专业或无关问题实现 100% 拦截，有效抑制模型幻觉。

## 3. 代码结构说明

本项目采用模块化开发，各环节脚本说明如下：

### 核心生产链路

- `step01_process_data.py`：语料清洗与文本分块处理，将教材内容转化为检索单元。
- `step02_build_db.py`：**[核心]** 构建 FAISS 向量数据库，包含多源数据融合与页码偏移量修正逻辑。
- `step03_test_llm.py`：本地环境大模型基础调用测试与角色定制。
- `step04_rag_cloud.py`：RAG 全链路推理测试脚本。
- `step05_data_augmentation_local.py`：数据增强脚本，用于生成评估数据集。

### 应用与评估

- `step06_rag_web_demo.py`：**[启动入口]** 基于 Streamlit 开发的交互式 Web 问答终端，集成侧边栏配置与对话历史管理。
- `step07_evaluation.py`：量化评估脚本，计算 RAG 系统的召回率（Recall）与 F1 分数，并生成 Excel 测试报告。

### 资源文件

- `data/`：存放原始 PDF 教材及清洗后的中间数据。
- `vector_db/`：FAISS 向量索引文件。
- `eval_dataset.json`：包含标准答案（Ground Truth）的测试数据集。
- `requirements.txt`：项目依赖库列表。

## 4. 环境安装

### 运行环境要求

- **操作系统**：Windows / Linux
- **Python版本**：Python 3.10+
- **硬件建议**：显存 6GB+（推荐），支持 CPU 模式运行。

### 依赖安装

请在终端执行以下命令安装核心依赖库：

```bash
pip install -r requirements.txt
```

## 5. 快速启动 (Quick Start)

本项目提供了可视化的 Web 界面，请通过以下命令启动系统：

Bash



```
streamlit run step06_rag_web_demo.py
```

启动成功后，浏览器将自动打开 `http://localhost:8501`，即可进行对话交互。

## 6. 系统评估 (Evaluation)

基于 `eval_dataset.json` 对系统进行的量化测试结果如下：

| **指标**            | **说明**                         | **结果**                             |
| ------------------- | -------------------------------- | ------------------------------------ |
| **Recall (召回率)** | 衡量知识点检索的覆盖程度         | **58.97%(较 Baseline 提升 22.31%)**  |
| **F1 Score**        | 衡量回答准确度与完整性的综合指标 | **0.2946** (较 Baseline 提升 49.13%) |
| **幻觉拦截率**      | 对非相关问题的拒答能力           | **100%**                             |

> 注：评估基于 jieba 分词与模糊匹配算法。

------

